% Sphere cone aerodynamics - drag only
% Data from Ian Clark


%% Prepare workspace
clear all; close all; clc;


%% Inputs
len = 100;


%% 70 deg Sphere Cone
% Reference:
%  Edquist, K. T., et al., "Aerodynamics for the Mars Phoenix Entry 
%    Capsule," AIAA 2008-7219.

data = [0.4, 0.0, 1.045; ...
        0.6, 0.0, 1.09; ...
        0.8, 0.0, 1.16; ...
        0.9, 0.0, 1.22; ...
        1.0, 0.0, 1.30; ...
        1.2, 0.0, 1.42; ...
        1.5, 0.0, 1.54; ...
        2.0, 0.0, 1.57; ...
        3.0, 0.0, 1.58; ...
        4.1, 0.0, 1.59; ...
        5.1, 0.0, 1.60; ...
        6.3, 0.0, 1.61 ];
    
% Reformat data
table = reformat_data(data, len);     

figure; hold on; box on; grid on;
plot(data(:,1),data(:,3),'bo');
plot(table(:,1),table(:,3),'r');
xlabel('Mach, nd');
ylabel('C_D, nd');
title('70 deg Sphere Cone');

% Create MAT file
save( 'aero_sphere_cone_70deg', 'table' );

clear data table;


%% 60 deg Sphere Cone
% Reference:
%   M=[0.6,1.3]: Marko, Wayne J., "Static Aerodynamic Characteristics of 
%     Three Blunted Sixty-Degree Half-Cones at Mach Numbers From 0.60 to 
%     1.30," JPL Technical Report 32-1298
%   M=[2.2,9.45]: Walker, B., and Weaver, R. W., "Static Aerodynamic 
%     Characteristics of Blunted Cones in the Mach-Number Range from 2.2 to
%     9.5," JPL Technical Report 32-1213
data = [0.60, 0.0, 0.965; ...
        0.75, 0.0, 1.008; ...
        0.85, 0.0, 1.044; ...
        1.00, 0.0, 1.152; ...
        1.15, 0.0, 1.372; ...
        1.30, 0.0, 1.431; ...
        2.20, 0.0, 1.570; ...
        3.00, 0.0, 1.545; ...
        4.00, 0.0, 1.535; ...
        5.00, 0.0, 1.525; ...
        6.00, 0.0, 1.510; ...
        7.25, 0.0, 1.510; ...
        9.45, 0.0, 1.530 ];
          
% Reformat data
table = reformat_data(data, len);     

figure; hold on; box on; grid on;
plot(data(:,1),data(:,3),'bo');
plot(table(:,1),table(:,3),'r');
xlabel('Mach, nd');
ylabel('C_D, nd');
title('60 deg Sphere Cone');

% Create MAT file
save( 'aero_sphere_cone_60deg', 'table' );

clear data table;
  

%% 45 deg Sphere Cone
% Reference:
%  Edquist, K. T., et al., "Aerodynamics for the Mars Phoenix Entry 
%    Capsule," AIAA 2008-7219.

data = [0.645, 0.0, 0.802; ...
        0.712, 0.0, 0.826; ...
        0.844, 0.0, 0.893; ...
        0.920, 0.0, 0.944; ...
        0.968, 0.0, 0.982; ...
        1.025, 0.0, 1.049; ...
        1.082, 0.0, 1.103; ...
        1.186, 0.0, 1.186; ...
        1.224, 0.0, 1.208; ...
        1.404, 0.0, 1.259; ...
        1.565, 0.0, 1.277; ...
        1.717, 0.0, 1.285; ...
        1.973, 0.0, 1.296; ...
        2.144, 0.0, 1.302; ...
        2.391, 0.0, 1.272; ...
        2.951, 0.0, 1.210; ...
        3.264, 0.0, 1.181; ...
        3.539, 0.0, 1.154; ...
        3.909, 0.0, 1.122; ...
        4.412, 0.0, 1.081; ...
        4.867, 0.0, 1.046; ...
        5.000, 0.0, 1.038 ];
          
% Reformat data
table = reformat_data(data, len);     

figure; hold on; box on; grid on;
plot(data(:,1),data(:,3),'bo');
plot(table(:,1),table(:,3),'r');
xlabel('Mach, nd');
ylabel('C_D, nd');
title('45 deg Sphere Cone');

% Create MAT file
save( 'aero_sphere_cone_45deg', 'table' );

clear data table;